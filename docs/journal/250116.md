# 250116

## 오늘 한 작업
- Drag and Drop 구현하기

## 사용한 Drag and Drop 이벤트 종류

### 카드에 사용한 것

- dragstart
    - dragging 클래스 추가
    - opacity 감소
    - dataTransfer text에 칼럼 ID와 카드 ID 추가하기 
- dragend
    - dragging 클래스 제거
    - opactiy 원복
    - dataTransfer text 클리어하기

### 카드를 담는 칼럼에 사용한 것
- dragover
    - 칼럼 위에 있을 때, 미리 잔상을 보여줄 위치 판단하기
    ```javascript
        function getDragAfterElement(container, mouseY) {
            const draggableElements = [
                ...container.querySelectorAll(".card-view:not(.dragging)")
            ];

            // reduce를 돌면서, "마우스가 이 요소의 가운데 위에 있는지, 아래에 있는지" 계산
            return draggableElements.reduce(
                (closest, child) => {
                const box = child.getBoundingClientRect();
                // 요소의 세로 중앙점
                const offset = mouseY - (box.top + box.height / 2);

                // offset이 0보다 작다는 것은
                // "드래그 중인 요소가 child의 위에 있다"는 뜻
                // 근데 그 중에서도 offset이 가장 큰(가장 근접한) child를 찾아야 함
                // 밑에 있는 경우도 고려해야함

                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                }
                else {
                    return closest;
                }
                },
                { offset: Number.NEGATIVE_INFINITY }
            ).element;
            }
    ```
    - 위치에 따라 카드 전 삽입 혹은 마지막에 놓을지 판단하였습니다.
- drop
    - dataTransfer 객체를 통해서 store을 업데이트 하고, 리렌더링 시켰습니다.

### 부족했던 점
- 아직 여러가지 버그들이 존재하는데, CardList 컴포넌트 안에서만 움직일 수 있기도 하고, 그 이외 범위로 나가면 카드의 잔상이 생기지 않는 문제가 발생했다.

### 내일 할 것
- 미리 위치를 계산해 이동해보는 애니메이션 구현하기
- 수업 복습하기


